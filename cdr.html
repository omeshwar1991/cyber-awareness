<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>ProbeMind — CDR Analysis</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root { --header-h: 64px; --footer-h: 44px; }
    * { box-sizing: border-box; }
    html, body { height: 100%; margin: 0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, "Noto Sans", sans-serif; color: #eaeaea; background: #0b0f16; overflow: hidden; }
    #bg { position: fixed; inset: 0; z-index: 0; background: radial-gradient(1200px 800px at 50% 50%, #0e1624 0%, #0b0f16 60%, #070a0f 100%); }
    header, footer {
      position: fixed; left: 0; right: 0; z-index: 2;
      backdrop-filter: blur(10px);
      background: linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0.02));
      border-bottom: 1px solid rgba(255,255,255,0.06);
    }
    header { top: 0; height: var(--header-h); display: flex; align-items: center; padding: 0 16px; }
    footer { bottom: 0; height: var(--footer-h); display: flex; align-items: center; justify-content: space-between; padding: 0 16px; border-top: 1px solid rgba(255,255,255,0.08); border-bottom: none; }
    .brand { font-weight: 800; letter-spacing: 0.5px; font-size: 18px; margin-right: 16px; white-space: nowrap; }
    nav a { color: #eaeaea; text-decoration: none; margin: 0 10px; padding: 8px 12px; border-radius: 999px; }
    nav a:hover { background: rgba(255,255,255,0.08); }
    nav a.active { background: #14b8a6; color: #021012; }
    main { position: relative; z-index: 1; height: calc(100% - var(--header-h) - var(--footer-h)); margin-top: var(--header-h); margin-bottom: var(--footer-h); overflow: auto; }
    .wrap { max-width: 900px; margin: 0 auto; padding: 28px 16px 40px; }
    .panel { background: rgba(255,255,255,0.06); border: 1px solid rgba(255,255,255,0.09); border-radius: 20px; padding: 20px; box-shadow: 0 20px 60px rgba(0,0,0,0.45), inset 0 1px 0 rgba(255,255,255,0.06); }
    h1 { margin: 10px 0 18px; font-size: clamp(22px, 3.6vw, 34px); }
    input[type="file"] {
      padding: 12px 14px; border-radius: 12px; border: 1px solid rgba(255,255,255,0.18);
      background: rgba(0,0,0,0.35); color: #eaeaea; font-size: 16px;
    }
    button {
      margin-top: 12px; padding: 12px 16px; border-radius: 12px;
      background: #14b8a6; color: #041012; border: none; font-weight: 700; cursor: pointer;
    }
    button:hover { transform: translateY(-1px); box-shadow: 0 10px 24px rgba(20,184,166,0.25); }
    .result { margin-top: 16px; padding: 14px; border-radius: 14px; background: rgba(20,184,166,0.08); border: 1px solid rgba(20,184,166,0.35); white-space: pre-wrap; }
  </style>
</head>
<body>
  <canvas id="bg"></canvas>

  <header>
    <div class="brand">ProbeMind</div>
    <nav>
      <a href="index.html">Home Page</a>
      <a href="ifsc.html">IFSC Search</a>
      <a href="ip.html">IP Lookup</a>
      <a href="tower.html">Tower Search</a>
      <a class="active" href="cdr.html">CDR Analysis</a>
    </nav>
  </header>

  <main>
    <div class="wrap">
      <div class="panel">
        <h1>CDR Analysis</h1>
        <input id="file" type="file" accept=".csv,.xlsx,.xls,.xlsb" />
        <button id="btn">Upload & Analyze</button>
        <div id="out" class="result" hidden></div>
      </div>
    </div>
  </main>

  <footer>
    <div class="footer-left">© 2025 ProbeMind.in</div>
    <div class="footer-right">Developed by Omeshwar Vankar</div>
  </footer>

  <script>
    const elFile = document.getElementById('file');
    const elBtn = document.getElementById('btn');
    const elOut = document.getElementById('out');

    elBtn.addEventListener('click', async () => {
      if (!elFile.files.length) {
        alert("Please select a CDR file first!");
        return;
      }
      elOut.hidden = false;
      elOut.textContent = "⏳ Uploading & analyzing...";

      const fd = new FormData();
      fd.append("file", elFile.files[0]);

      try {
        const r = await fetch("/api/cdr", { method: "POST", body: fd });
        if (r.ok) {
          const blob = await r.blob();
          const url = URL.createObjectURL(blob);
          const a = document.createElement("a");
          a.href = url;
          a.download = "CDR_Analysis_Report.xlsx";
          a.click();
          elOut.textContent = "✅ Analysis complete. Report downloaded.";
        } else {
          elOut.textContent = "❌ Error analyzing CDR file.";
        }
      } catch (e) {
        elOut.textContent = "⚠️ Network error: " + e;
      }
    });
  </script>
</body>
</html>
