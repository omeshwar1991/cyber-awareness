<!DOCTYPE html>
<html lang="hi">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Combined Numerology Calculator (Name + DOB)</title>

<!-- Bootstrap CSS (CDN) -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

<style>
  :root{
    --bg: #121212; --text:#e8e8e8; --card:#1e1e1e; --accent:#64b5f6; --input:#2c2c2c;
  }
  body.light { --bg:#f7f9fc; --text:#1f1f1f; --card:#ffffff; --accent:#1976d2; --input:#ffffff; }
  body {
    background: var(--bg);
    color: var(--text);
    font-family: "Segoe UI", Roboto, Arial, sans-serif;
    padding: 28px;
    transition: background .3s, color .3s;
  }
  .card-main {
    max-width: 760px;
    margin: 8px auto;
    background: var(--card);
    border-radius: 12px;
    padding: 20px;
    box-shadow: 0 6px 20px rgba(0,0,0,0.35);
  }
  h1 { color: var(--accent); font-weight:600; }
  input, select { background: var(--input); color: var(--text); border:1px solid rgba(255,255,255,0.06); }
  .theme-btn {
    position: fixed; right: 18px; top: 18px;
    background: var(--accent); color: white; border: none; padding: 8px 12px; border-radius: 999px; cursor:pointer;
    z-index: 9999;
  }
  .result-box { margin-top: 18px; background: rgba(255,255,255,0.02); padding: 16px; border-radius:10px; }
  .section { margin-top:10px; padding:10px; border-radius:8px; background: rgba(0,0,0,0.08); }
  .muted { color: #bdbdbd; font-size: 0.95rem; }
  b { color: var(--accent); }
  .download-btn { margin-right:8px; }
  @media (max-width:575px){
    .card-main { padding: 16px; }
  }
</style>
</head>
<body>

<button class="theme-btn" id="themeToggle">ЁЯМЩ Dark</button>

<div class="card-main">
  <div class="text-center">
    <h1>ЁЯФв Numerology тАФ Name + Birth Date</h1>
    <p class="muted">рдирд╛рдо рдФрд░ рдЬрдиреНрдорддрд┐рдерд┐ рдбрд╛рд▓реЗрдВ тАФ рдлрд┐рд░ Name Number, Life Path Number рдФрд░ рджреЛрдиреЛрдВ рдХреА рд╕рд▓рд╛рд╣ рдкрд╛рдпреЗрдВ</p>
  </div>

  <div class="row g-3">
    <div class="col-md-8">
      <label class="form-label">рдкреВрд░рд╛ рдирд╛рдо</label>
      <input id="nameInput" class="form-control" placeholder="рдЙрджрд╛рд╣рд░рдг: Devanshi Patel" />
    </div>

    <div class="col-md-4">
      <label class="form-label">рдЬрдиреНрдорддрд┐рдерд┐ (DOB)</label>
      <!-- date input (browser date-picker) -->
      <input id="dobInput" type="date" class="form-control" />
    </div>

    <div class="col-12 text-center">
      <button class="btn btn-primary w-100" onclick="calculateAll()">Calculate</button>
    </div>
  </div>

  <div id="result" class="result-box" style="display:none;">
    <div id="letters" class="muted"></div>
    <div id="nameTotal" class="mt-2"></div>
    <div id="lifeTotal" class="mt-2"></div>

    <div id="meaningName" class="section"></div>
    <div id="meaningLife" class="section"></div>
    <div id="compat" class="section"></div>

    <div class="d-flex flex-wrap justify-content-center mt-3">
      <button class="btn btn-sm download-btn" onclick="downloadPDF()">ЁЯУД Save as PDF</button>
      <button class="btn btn-sm download-btn" onclick="downloadImage()">ЁЯУ╕ Save as Image</button>
      <button class="btn btn-sm btn-outline-light ms-1" onclick="copyResult()">ЁЯФЧ Copy Text</button>
    </div>
  </div>

  <div class="mt-3 muted">
    <small>
      рдиреЛрдЯ: Name Number рдХреИрд▓рдХреБрд▓реЗрд╢рди рдЖрдкрдХреА рдЕрд▓реНрдлрд╛рдиреНрдпреВрдореЗрд░рд┐рдХ рддрд╛рд▓рд┐рдХрд╛ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рд╣реИ (A,I,J,Q,Y=1 ... F,P=8)ред Life Path Number рдЬрдиреНрдорддрд┐рдерд┐ рдХреЗ рд╕рднреА рдЕрдВрдХреЛрдВ рдХреЗ рдпреЛрдЧ рдХреЛ single digit рддрдХ рдШрдЯрд╛рдХрд░ рдорд┐рд▓рддрд╛ рд╣реИред
    </small>
  </div>
</div>

<!-- libraries -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<script>
/* ---------------- mapping рдФрд░ data ---------------- */
const mapping = {
  'A':1,'I':1,'J':1,'Q':1,'Y':1,
  'B':2,'K':2,'R':2,
  'C':3,'G':3,'L':3,'S':3,
  'D':4,'M':4,'T':4,
  'E':5,'H':5,'N':5,'X':5,
  'U':6,'V':6,'W':6,
  'O':7,'Z':7,
  'F':8,'P':8
};

const data = {
  1:{ meaning:"рдиреЗрддреГрддреНрд╡, рдЖрддреНрдорд╡рд┐рд╢реНрд╡рд╛рд╕реА рдФрд░ рд╕реБрд░реБрдЪрд┐рдкреВрд░реНрдг рд╢реБрд░реБрдЖрддред рдирд┐рд░реНрдгрдп рд▓реЗрдиреЗ рдореЗрдВ рддреЗрдЬрд╝ред", color:"рд▓рд╛рд▓", day:"рд░рд╡рд┐рд╡рд╛рд░", gem:"Ruby", profession:"Leader, Entrepreneur" },
  2:{ meaning:"рд╕рд╣рдпреЛрдЧреА, рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдФрд░ рд╕рдВрддреБрд▓рди рдкреНрд░рд┐рдпред рд╕рдВрдмрдВрдзреЛрдВ рдореЗрдВ рдордЬрдмреВрддред", color:"рд╕рдлреЗрдж/рд╣рд▓реНрдХрд╛ рдиреАрд▓рд╛", day:"рд╕реЛрдорд╡рд╛рд░", gem:"Pearl", profession:"Counselor, Teacher" },
  3:{ meaning:"рд░рдЪрдирд╛рддреНрдордХ, рдмреЛрд▓рдиреЗ-рд▓рд┐рдЦрдиреЗ рдореЗрдВ рдирд┐рдкреБрдг рдФрд░ рдЦреБрд╢рдорд┐рдЬрд╝рд╛рдЬред", color:"рдкреАрд▓рд╛/рдЧреБрд▓рд╛рдмреА", day:"рдЧреБрд░реБрд╡рд╛рд░", gem:"Yellow Sapphire", profession:"Artist, Writer" },
  4:{ meaning:"рд╡реНрдпрд╡рд╕реНрдерд┐рдд, рдореЗрд╣рдирддреА рдФрд░ рднрд░реЛрд╕реЗрдордВрджред рдирд┐рдпрдореЛрдВ рдХрд╛ рдкрд╛рд▓рдиред", color:"рдиреАрд▓рд╛/рдЧреНрд░реЗ", day:"рдмреБрдзрд╡рд╛рд░", gem:"Gomed", profession:"Engineer, Admin" },
  5:{ meaning:"рд╕реНрд╡рддрдВрддреНрд░, рд╕рд╛рд╣рд╕реА рдФрд░ рдкрд░рд┐рд╡рд░реНрддрдирд╢реАрд▓ред рдпрд╛рддреНрд░рд╛, рдореАрдбрд┐рдпрд╛ рдореЗрдВ рдЕрдЪреНрдЫрд╛ред", color:"рдлрд┐рд░реЛрдЬрд╝реА", day:"рдмреБрдзрд╡рд╛рд░", gem:"Emerald", profession:"Marketing, Travel" },
  6:{ meaning:"рдкреЛрд╖рдХ, рдкрд░рд┐рд╡рд╛рд░-рдкреНрд░реЗрдореА рдФрд░ рдЬрд┐рдореНрдореЗрджрд╛рд░ред", color:"рд╣рд░рд╛/рдХреНрд░реАрдо", day:"рд╢реБрдХреНрд░рд╡рд╛рд░", gem:"Diamond", profession:"Doctor, Designer" },
  7:{ meaning:"рдЧрд╣рди рд╡рд┐рдЪрд╛рд░рдХ, рдЕрдзреНрдпрд╛рддреНрдо рдФрд░ рдЦреЛрдЬреА рдЖрддреНрдорд╛ред", color:"рд╕рдлреЗрдж/рд╣рд▓реНрдХрд╛ рд╣рд░рд╛", day:"рд╕реЛрдорд╡рд╛рд░", gem:"Cat's Eye", profession:"Research, Spiritual" },
  8:{ meaning:"рдзрди, рд╢рдХреНрддрд┐ рдФрд░ рдкреНрд░рднрд╛рд╡рдХ рдХреНрд╖рдорддрд╛ред рдиреЗрддреГрддреНрд╡ рдореЗрдВ рдкреИрдаред", color:"рдХрд╛рд▓рд╛/рдЧрд╣рд░рд╛ рдиреАрд▓рд╛", day:"рд╢рдирд┐рд╡рд╛рд░", gem:"Blue Sapphire", profession:"Business, Finance" },
  9:{ meaning:"рд╕реЗрд╡рд╛, рдХрд░реБрдгрд╛ рдФрд░ рд╕рдорд░реНрдкрдгред рд╕рдорд╛рдЬ рдирд┐рд░реНрдорд╛рдг рдореЗрдВ рд░реБрдЪрд┐ред", color:"рд▓рд╛рд▓/рд╕реБрдирд╣рд░рд╛", day:"рдордВрдЧрд▓рд╡рд╛рд░", gem:"Coral", profession:"Medical, Social Work" }
};

/* ------------- Helper Functions ------------- */
function reduceToSingle(n) {
  n = Math.abs(Math.floor(n));
  while (n > 9) {
    let s = 0;
    while (n > 0) { s += n % 10; n = Math.floor(n/10); }
    n = s;
  }
  return n === 0 ? 0 : n;
}

function calculateNameNumber(fullName) {
  const cleaned = (fullName || "").toUpperCase().replace(/[^A-Z]/g, '');
  let total = 0;
  const breakdown = [];
  for (const ch of cleaned) {
    const v = mapping[ch] || 0;
    breakdown.push(`${ch}=${v}`);
    total += v;
  }
  const reduced = reduceToSingle(total);
  return { total, reduced, breakdown };
}

function calculateLifePathFromDate(isoDate) {
  // isoDate from <input type="date"> is yyyy-mm-dd or empty
  if (!isoDate) return null;
  // convert to DDMMYYYY digits
  const [y,m,d] = isoDate.split('-');
  const digits = (d + m + y).replace(/[^0-9]/g,'').split('').map(Number);
  const sum = digits.reduce((a,b)=>a+b,0);
  const reduced = reduceToSingle(sum);
  return { sum, reduced, digits };
}

/* ------------- Compatibility / Advice ------------- */
function compatibilityAdvice(nameNum, lifeNum) {
  if (!nameNum || !lifeNum) return "рджреЛрдиреЛрдВ рдирдВрдмрд░ рдЙрдкрд▓рдмреНрдз рдирд╣реАрдВ рд╣реИрдВ рдЗрд╕рд▓рд┐рдП compatibility рд╕реБрдЭрд╛рд╡ рд╕реАрдорд┐рдд рд╣реИред";
  if (nameNum === lifeNum) {
    return `рдЖрдкрдХрд╛ Name Number рдФрд░ Life Path Number рджреЛрдиреЛрдВ <b>${nameNum}</b> рд╣реИрдВ тАФ рдпрд╣ рдмрд╣реБрдд рд╕рдордиреНрд╡рд┐рдд рд╕рдВрдХреЗрдд рд╣реИред рдЖрдкрдХреА рдЬрд╝рд┐рдиреНрджрдЧреА рдореЗрдВ рдирд╛рдо рдФрд░ рдорд╛рд░реНрдЧ рдПрдХ-рджреВрд╕рд░реЗ рдХреЛ рд╕рдкреЛрд░реНрдЯ рдХрд░реЗрдВрдЧреЗред рдиреЗрддреГрддреНрд╡ (рдпрд╛ рд╡рд┐рд╖рдп рдХреЗ рдЕрдиреБрд╕рд╛рд░) рдореЗрдВ рдирд┐рд░рдВрддрд░рддрд╛ рдорд╣рд╕реВрд╕ рд╣реЛрдЧреАред`;
  }
  // simple complementary/friendly pairs (common friendly pairs)
  const friendlyPairs = [
    [1,5],[5,1],[2,6],[6,2],[3,9],[9,3],[4,8],[8,4],[7,7]
  ];
  for (const p of friendlyPairs) {
    if (p[0]===nameNum && p[1]===lifeNum) {
      return `Name Number <b>${nameNum}</b> рдФрд░ Life Path <b>${lifeNum}</b> рдЖрдорддреМрд░ рдкрд░ рдЕрдЪреНрдЫреА рддрд╛рд▓рдореЗрд▓ рд░рдЦрддреЗ рд╣реИрдВред рдЖрдк рдЕрдкрдиреА рдкреНрд░рд╡реГрддреНрддрд┐ (name number) рдХреЛ рдЕрдкрдиреЗ рдЬреАрд╡рди рдкрде (life number) рдХреЗ рдЕрд╡рд╕рд░реЛрдВ рдореЗрдВ рд╕рдлрд▓рддрд╛рдкреВрд░реНрд╡рдХ рд▓рдЧрд╛ рдкрд╛рдПрдБрдЧреЗред`;
    }
  }
  // general guidance if not matched
  // compare nature: practical vs creative, leadership vs service
  const text = [];
  const N = data[nameNum]?.meaning || "";
  const L = data[lifeNum]?.meaning || "";
  text.push(`Name Number (${nameNum}): ${N}`);
  text.push(`Life Path (${lifeNum}): ${L}`);
  text.push("рд╕реБрдЭрд╛рд╡: рдЕрдкрдиреЗ рдирд╛рдо рдХреА рдкреНрд░рдХреГрддрд┐ рдФрд░ рдЬреАрд╡рди рдкрде рдХреЗ рд▓рдХреНрд╖реНрдпреЛрдВ рдкрд░ рдзреНрдпрд╛рди рджреЗрдВ тАФ рдЬрд╣рд╛рдБ рдЕрд▓рдЧ рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдБ рд╣реЛрдВ рд╡рд╣рд╛рдБ рд╕рдВрддреБрд▓рди рдмрдирд╛рдЗрдПред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП:");
  if (nameNum === 1 && lifeNum === 7) text.push("рдиреЗрддреГрддреНрд╡ рдФрд░ рдЖрддреНрдо-рдЦреЛрдЬ рдХрд╛ рдореЗрд▓ тАФ рдирд┐рд░реНрдгрдпреЛрдВ рдореЗрдВ рдзреНрдпрд╛рди рд╡ рдЪрд┐рдВрддрди рд░рдЦреЗрдВред");
  if (nameNum === 5 && lifeNum === 4) text.push("рдЙрддреНрд╕рд╛рд╣ рдФрд░ рдЕрдиреБрд╢рд╛рд╕рди рдХрд╛ рд╕рдВрддреБрд▓рди рдЬрд╝рд░реВрд░реА рд╣реИ тАФ рдпреЛрдЬрдирд╛рдПрдБ рдмрдирд╛рдХрд░ рдпрд╛рддреНрд░рд╛ рдХрд░реЗрдВред");
  if (text.length === 3) text.push("рд▓реЛ-рд▓реЗрд╡рд▓ рд╕рд▓рд╛рд╣: рдЕрдиреБрд╢рд╛рд╕рди, рдзреИрд░реНрдп рдФрд░ рд░рдгрдиреАрддрд┐ рдЕрдкрдирд╛рдПрдБтАФрд╡рд┐рд╢реЗрд╖рдХрд░ рдХрд░рд┐рдпрд░/рд░рд┐рд▓реЗрд╢рдирд╢рд┐рдк рдореЗрдВред");
  return text.join("<br>");
}

/* ------------- Main Calculate & UI ------------- */
function calculateAll() {
  const name = document.getElementById('nameInput').value.trim();
  const dob = document.getElementById('dobInput').value; // yyyy-mm-dd

  if (!name && !dob) { alert("рдХреГрдкрдпрд╛ рдирд╛рдо рдФрд░/рдпрд╛ рдЬрдиреНрдорддрд┐рдерд┐ рджрд░реНрдЬ рдХрд░реЗрдВред"); return; }

  // Name calc
  const nameRes = calculateNameNumber(name);
  // Life path calc
  const lifeRes = calculateLifePathFromDate(dob);

  // render
  document.getElementById('result').style.display = 'block';
  document.getElementById('letters').innerHTML = name ? `<b>Letter Breakdown:</b> ${nameRes.breakdown.join(', ')}` : `<b>Letter Breakdown:</b> (рдирд╛рдо рдЙрдкрд▓рдмреНрдз рдирд╣реАрдВ)`;
  document.getElementById('nameTotal').innerHTML = name ? `<b>Name Total:</b> ${nameRes.total} тЖТ <b>Name Number:</b> ${nameRes.reduced}` : '';
  document.getElementById('lifeTotal').innerHTML = lifeRes ? `<b>Life Path Sum:</b> ${lifeRes.sum} тЖТ <b>Life Path Number:</b> ${lifeRes.reduced}` : '';

  // meanings
  if (name) {
    const nm = nameRes.reduced || 0;
    const info = data[nm] || {};
    document.getElementById('meaningName').innerHTML = `<b>Name (${nm}) Meaning:</b> ${info.meaning || 'тАФ' } <br><small class="muted">Lucky Color: ${info.color || '-'} тАв Lucky Day: ${info.day || '-'}</small>`;
  } else { document.getElementById('meaningName').innerHTML = ''; }

  if (lifeRes) {
    const ln = lifeRes.reduced;
    const info2 = data[ln] || {};
    document.getElementById('meaningLife').innerHTML = `<b>Life Path (${ln}) Meaning:</b> ${info2.meaning || 'тАФ'} <br><small class="muted">Lucky Color: ${info2.color || '-'} тАв Lucky Day: ${info2.day || '-'}</small>`;
  } else { document.getElementById('meaningLife').innerHTML = ''; }

  // compatibility
  const nameNum = name ? nameRes.reduced : null;
  const lifeNum = lifeRes ? lifeRes.reduced : null;
  document.getElementById('compat').innerHTML = `<b>Combined Guidance / Compatibility:</b><br>${compatibilityAdvice(nameNum, lifeNum)}`;
}

/* ------------- Download / Copy features ------------- */
async function downloadPDF(){
  const { jsPDF } = window.jspdf;
  const el = document.getElementById('result');
  // ensure visible and slightly larger scale for quality
  const canvas = await html2canvas(el, { scale: 2, backgroundColor: null });
  const img = canvas.toDataURL('image/png');
  const pdf = new jsPDF('p','mm','a4');
  const pdfW = pdf.internal.pageSize.getWidth();
  const pdfH = (canvas.height * pdfW) / canvas.width;
  pdf.addImage(img, 'PNG', 0, 0, pdfW, pdfH);
  pdf.save('Numerology_Result.pdf');
}

async function downloadImage(){
  const el = document.getElementById('result');
  const canvas = await html2canvas(el, { scale: 2, backgroundColor: null });
  const link = document.createElement('a');
  link.download = 'Numerology_Result.png';
  link.href = canvas.toDataURL('image/png');
  document.body.appendChild(link);
  link.click();
  link.remove();
}

function copyResult() {
  const el = document.getElementById('result');
  // produce readable plain-text
  let text = '';
  const letters = document.getElementById('letters').innerText;
  const nt = document.getElementById('nameTotal').innerText;
  const lt = document.getElementById('lifeTotal').innerText;
  const mn = document.getElementById('meaningName').innerText;
  const ml = document.getElementById('meaningLife').innerText;
  const comp = document.getElementById('compat').innerText;
  text = [letters, nt, lt, mn, ml, comp].filter(Boolean).join('\n\n');
  navigator.clipboard.writeText(text).then(()=> {
    alert('Result copied to clipboard!');
  }).catch(()=> {
    alert('Copy failed тАФ рдЖрдк рдореИрдиреНрдпреБрдЕрд▓реА рдХреЙрдкреА рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред');
  });
}

/* ------------- Theme toggle persistence ------------- */
const themeBtn = document.getElementById('themeToggle');
function setThemeFromLocal() {
  const theme = localStorage.getItem('nm_theme') || 'dark';
  if (theme === 'light') { document.body.classList.add('light'); themeBtn.innerText = 'ЁЯМЮ Light'; }
  else { document.body.classList.remove('light'); themeBtn.innerText = 'ЁЯМЩ Dark'; }
}
function toggleTheme() {
  document.body.classList.toggle('light');
  const isLight = document.body.classList.contains('light');
  localStorage.setItem('nm_theme', isLight ? 'light' : 'dark');
  themeBtn.innerText = isLight ? 'ЁЯМЮ Light' : 'ЁЯМЩ Dark';
}
themeBtn.addEventListener('click', toggleTheme);
setThemeFromLocal();

</script>

</body>
</html>
